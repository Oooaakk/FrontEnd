{"ast":null,"code":"import HubIcon from '@/components/HubIcon.vue';\nimport request from \"@/utils/RequestFile.js\";\nexport default {\n  data() {\n    return {\n      components: {\n        HubIcon\n      },\n      ruleForm: {\n        uname: \"\",\n        password: \"\"\n      },\n      rules: {\n        uname: [{\n          message: \"用户名不能为空！\",\n          trigger: \"blur\"\n        }],\n        password: [{\n          message: \"密码不能为空！\",\n          trigger: \"blur\"\n        }]\n      },\n      loading: false\n    };\n  },\n\n  methods: {\n    submitForm(formName) {\n      console.log(\"submit\"); // 验证表单中的账号密码是否有效，因为在上面rules中定义为了必填 required: true\n\n      this.$refs[formName].validate(valid => {\n        // 点击登录后，让登录按钮开始转圈圈（展示加载动画）\n        this.loading = true; // 如果经过校验，账号密码都不为空，则发送请求到后端登录接口\n\n        if (valid) {\n          console.log('submit!');\n          request.post(\"/user/login\", {\n            email: this.ruleForm.uname,\n            password: this.ruleForm.password\n          }).then(res => {\n            if (res.status === 200) {\n              console.log(\"success\");\n              this.$router.push('/moviehub/mainpageuser/' + '12345');\n            }\n          });\n          /*let _this = this;\r\n          // 使用 axios 将登录信息发送到后端\r\n          this.axios({\r\n            url:  '/api/user/hello',               // 请求地址\r\n            method: \"post\",                       // 请求方法\r\n            headers: {                            // 请求头\r\n              \"Content-Type\": \"application/json\",\r\n            },\r\n            params: {                             // 请求参数\r\n              uname: _this.ruleForm.uname,\r\n              password: _this.ruleForm.password,\r\n            },\r\n          }).then((res) => { // 当收到后端的响应时执行该括号内的代码，res 为响应信息，也就是后端返回的信息\r\n            if (res.data.code === \"0\") {  // 当响应的编码为 0 时，说明登录成功\r\n              // 将用户信息存储到sessionStorage中\r\n              console.log(\"success\");\r\n              // 显示后端响应的成功信息\r\n              this.$message({\r\n                message: res.data.msg,\r\n                type: \"success\",\r\n              });\r\n            } else {  // 当响应的编码不为 0 时，说明登录失败\r\n              // 显示后端响应的失败信息\r\n              this.$message({\r\n                message: res.data.msg,\r\n                type: \"warning\",\r\n              });\r\n            }\r\n            // 不管响应成功还是失败，收到后端响应的消息后就不再让登录按钮显示加载动画了\r\n            _this.loading = false;\r\n            console.log(res);\r\n          });*/\n        } else {\n          // 如果账号或密码有一个没填，就直接提示必填，不向后端请求\n          console.log(\"error submit!!\");\n          this.loading = false;\n          return false;\n        }\n      });\n    },\n\n    resetForm(formName) {\n      this.$refs[formName].resetFields();\n    }\n\n  },\n  components: {\n    HubIcon\n  }\n};","map":{"version":3,"mappings":"AA+CA,OAAOA,OAAP,MAAoB,0BAApB;AACA,OAAOC,OAAP,MAAoB,wBAApB;AACA,eAAe;EACbC,IAAI,GAAG;IACH,OAAO;MACHC,UAAU,EAAE;QACRH;MADQ,CADT;MAIHI,QAAQ,EAAE;QACNC,KAAK,EAAE,EADD;QAENC,QAAQ,EAAE;MAFJ,CAJP;MAQHC,KAAK,EAAE;QACHF,KAAK,EAAE,CACH;UAAEG,OAAO,EAAE,UAAX;UAAuBC,OAAO,EAAE;QAAhC,CADG,CADJ;QAIHH,QAAQ,EAAE,CACN;UAAEE,OAAO,EAAE,SAAX;UAAsBC,OAAO,EAAE;QAA/B,CADM;MAJP,CARJ;MAgBHC,OAAO,EAAE;IAhBN,CAAP;EAkBH,CApBY;;EAqBbC,OAAO,EAAE;IACLC,UAAU,CAACC,QAAD,EAAW;MACjBC,OAAO,CAACC,GAAR,CAAY,QAAZ,EADiB,CAEvB;;MACE,KAAKC,KAAL,CAAWH,QAAX,EAAqBI,QAArB,CAA+BC,KAAD,IAAW;QACzC;QACA,KAAKR,OAAL,GAAe,IAAf,CAFyC,CAGzC;;QACA,IAAIQ,KAAJ,EAAW;UACPJ,OAAO,CAACC,GAAR,CAAY,SAAZ;UACAd,OAAO,CAACkB,IAAR,CAAa,aAAb,EAA4B;YAACC,KAAK,EAAE,KAAKhB,QAAL,CAAcC,KAAtB;YAA6BC,QAAQ,EAAE,KAAKF,QAAL,CAAcE;UAArD,CAA5B,EAA4Fe,IAA5F,CAAiGC,GAAE,IAAK;YACtG,IAAGA,GAAG,CAACC,MAAJ,KAAe,GAAlB,EAAsB;cACpBT,OAAO,CAACC,GAAR,CAAY,SAAZ;cACA,KAAKS,OAAL,CAAaC,IAAb,CAAkB,4BAA0B,OAA5C;YACF;UAEP,CANK;UAOF;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;QAgCF,CAzCA,MAyCO;UAAG;UACRX,OAAO,CAACC,GAAR,CAAY,gBAAZ;UACA,KAAKL,OAAL,GAAe,KAAf;UACA,OAAO,KAAP;QACF;MACC,CAlDD;IAmDH,CAvDQ;;IAwDLgB,SAAS,CAACb,QAAD,EAAW;MAChB,KAAKG,KAAL,CAAWH,QAAX,EAAqBc,WAArB;IACH;;EA1DI,CArBI;EAiFbxB,UAAU,EAAE;IAAEH;EAAF;AAjFC,CAAf","names":["HubIcon","request","data","components","ruleForm","uname","password","rules","message","trigger","loading","methods","submitForm","formName","console","log","$refs","validate","valid","post","email","then","res","status","$router","push","resetForm","resetFields"],"sourceRoot":"","sources":["D:\\comp30022 frontend\\comp30022-movie-review-website\\moviehub_frontend\\src\\views\\LoginPage.vue"],"sourcesContent":["<template>\r\n  <div id= 'building'>\r\n      <HubIcon></HubIcon>\r\n  <div >\r\n    <el-card class=\"box-card\">\r\n      <h2 class = \"color\">Login</h2>\r\n      <el-form\r\n        :model=\"ruleForm\"\r\n        status-icon\r\n        :rules=\"rules\"\r\n        ref=\"ruleForm\"\r\n        label-position=\"left\"\r\n        label-width=\"100px\"\r\n        class=\"login-from\"\r\n        hide-required-aterisk=\"false\"\r\n      >\r\n        <el-form-item class = \"color1\" label=\"Username\" prop=\"uname\" >\r\n          <el-input v-model=\"ruleForm.uname\"></el-input>\r\n        </el-form-item>\r\n        <el-form-item class = \"color1\" label=\"Password\" prop=\"password\">\r\n          <el-input\r\n            type=\"password\"\r\n            v-model=\"ruleForm.password\"\r\n            autocomplete=\"off\"\r\n          ></el-input>\r\n        </el-form-item>\r\n      </el-form>\r\n      <div>\r\n      <a @click=\"$router.push('/moviehub/forgetpassword')\" class=\"forgetpass\">Forget password? Click here</a>\r\n      </div>\r\n      <div class=\"btnGroup\">\r\n          \r\n        <el-button type=\"primary\" @click=\"submitForm('ruleForm')\"\r\n        v-loading=\"loading\"\r\n          >Login\r\n          </el-button>\r\n        <el-button @click=\"resetForm('ruleForm')\">Reset</el-button>\r\n        <router-link to=\"/moviehub/RegisterPage\">\r\n          <el-button style=\"margin-left:10px\">Register</el-button>\r\n        </router-link>\r\n      </div>\r\n    </el-card>\r\n  </div>\r\n</div>\r\n</template>\r\n\r\n<script>\r\nimport HubIcon from '@/components/HubIcon.vue';\r\nimport request from \"@/utils/RequestFile.js\"\r\nexport default {\r\n  data() {\r\n      return {\r\n          components: {\r\n              HubIcon\r\n          },\r\n          ruleForm: {\r\n              uname: \"\",\r\n              password: \"\",\r\n          },\r\n          rules: {\r\n              uname: [\r\n                  { message: \"用户名不能为空！\", trigger: \"blur\"},\r\n              ],\r\n              password: [\r\n                  { message: \"密码不能为空！\", trigger: \"blur\"},\r\n              ],\r\n          },\r\n          loading: false,\r\n      };\r\n  },\r\n  methods: {\r\n      submitForm(formName) {\r\n          console.log(\"submit\");\r\n    // 验证表单中的账号密码是否有效，因为在上面rules中定义为了必填 required: true\r\n      this.$refs[formName].validate((valid) => {\r\n      // 点击登录后，让登录按钮开始转圈圈（展示加载动画）\r\n      this.loading = true;\r\n      // 如果经过校验，账号密码都不为空，则发送请求到后端登录接口\r\n      if (valid) {\r\n          console.log('submit!')\r\n          request.post(\"/user/login\", {email: this.ruleForm.uname, password: this.ruleForm.password}).then(res => {\r\n            if(res.status === 200){\r\n              console.log(\"success\");\r\n              this.$router.push('/moviehub/mainpageuser/'+'12345');\r\n            }\r\n        \r\n    })\r\n        /*let _this = this;\r\n        // 使用 axios 将登录信息发送到后端\r\n        this.axios({\r\n          url:  '/api/user/hello',               // 请求地址\r\n          method: \"post\",                       // 请求方法\r\n          headers: {                            // 请求头\r\n            \"Content-Type\": \"application/json\",\r\n          },\r\n          params: {                             // 请求参数\r\n            uname: _this.ruleForm.uname,\r\n            password: _this.ruleForm.password,\r\n          },\r\n        }).then((res) => { // 当收到后端的响应时执行该括号内的代码，res 为响应信息，也就是后端返回的信息\r\n          if (res.data.code === \"0\") {  // 当响应的编码为 0 时，说明登录成功\r\n            // 将用户信息存储到sessionStorage中\r\n            console.log(\"success\");\r\n            // 显示后端响应的成功信息\r\n            this.$message({\r\n              message: res.data.msg,\r\n              type: \"success\",\r\n            });\r\n          } else {  // 当响应的编码不为 0 时，说明登录失败\r\n            // 显示后端响应的失败信息\r\n            this.$message({\r\n              message: res.data.msg,\r\n              type: \"warning\",\r\n            });\r\n          }\r\n          // 不管响应成功还是失败，收到后端响应的消息后就不再让登录按钮显示加载动画了\r\n          _this.loading = false;\r\n          console.log(res);\r\n        });*/\r\n      } else {  // 如果账号或密码有一个没填，就直接提示必填，不向后端请求\r\n        console.log(\"error submit!!\");\r\n        this.loading = false;\r\n        return false;\r\n      }\r\n      });\r\n  },\r\n      resetForm(formName) {\r\n          this.$refs[formName].resetFields();\r\n      },\r\n  },\r\n  components: { HubIcon }\r\n};\r\n</script>\r\n\r\n<style >\r\n.color {\r\n  color: orange;\r\n}\r\n.forgetpass {\r\n  color: orange;\r\n}\r\n.color1 .el-form-item__label{\r\n  color : orange;\r\n}\r\n.box-card {\r\n  margin: auto auto;\r\n  margin-top: 150px;\r\n  width: 400px;\r\n}\r\n.login-from {\r\n  margin: auto auto;\r\n}\r\n#building{\r\nbackground:url('https://wallpapercave.com/dwp2x/wp11089675.jpg');\r\nwidth:100%;\r\nheight:100%;\r\nposition:fixed;\r\nbackground-size:100% 100%;\r\n}\r\n\r\n.btnGroup{\r\n  margin-top: 20px;\r\n}\r\n\r\n</style>"]},"metadata":{},"sourceType":"module"}