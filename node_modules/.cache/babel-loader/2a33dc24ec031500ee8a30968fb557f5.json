{"ast":null,"code":"import { createElementVNode as _createElementVNode, createCommentVNode as _createCommentVNode, resolveComponent as _resolveComponent, createVNode as _createVNode, withCtx as _withCtx, normalizeClass as _normalizeClass, toDisplayString as _toDisplayString, createTextVNode as _createTextVNode, withModifiers as _withModifiers, openBlock as _openBlock, createElementBlock as _createElementBlock, pushScopeId as _pushScopeId, popScopeId as _popScopeId } from \"vue\";\n\nconst _withScopeId = n => (_pushScopeId(\"data-v-2e7c8062\"), n = n(), _popScopeId(), n);\n\nconst _hoisted_1 = {\n  class: \"forgotpwd\"\n};\nconst _hoisted_2 = {\n  class: \"form_title\"\n};\nconst _hoisted_3 = {\n  class: \"manage_title\"\n};\n\nconst _hoisted_4 = /*#__PURE__*/_withScopeId(() => /*#__PURE__*/_createElementVNode(\"span\", {\n  class: \"title\"\n}, \"影片资金后台管理系统\", -1\n/* HOISTED */\n));\n\nconst _hoisted_5 = /*#__PURE__*/_withScopeId(() => /*#__PURE__*/_createElementVNode(\"div\", {\n  class: \"forgot_title\"\n}, [/*#__PURE__*/_createElementVNode(\"h3\", null, \"忘记密码\")], -1\n/* HOISTED */\n));\n\nconst _hoisted_6 = {\n  class: \"vertify\"\n};\nconst _hoisted_7 = {\n  class: \"forgot_button\"\n};\n\nconst _hoisted_8 = /*#__PURE__*/_createTextVNode(\"确定\");\n\nconst _hoisted_9 = {\n  class: \"tip_area\"\n};\n\nconst _hoisted_10 = /*#__PURE__*/_createTextVNode(\"想起密码，登录\");\n\nconst _hoisted_11 = /*#__PURE__*/_withScopeId(() => /*#__PURE__*/_createElementVNode(\"p\", null, \"注：若未收到验证码，请查看垃圾箱\", -1\n/* HOISTED */\n));\n\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  const _component_el_input = _resolveComponent(\"el-input\");\n\n  const _component_el_form_item = _resolveComponent(\"el-form-item\");\n\n  const _component_el_button = _resolveComponent(\"el-button\");\n\n  const _component_router_link = _resolveComponent(\"router-link\");\n\n  const _component_el_form = _resolveComponent(\"el-form\");\n\n  return _openBlock(), _createElementBlock(\"div\", _hoisted_1, [_createElementVNode(\"section\", _hoisted_2, [_createElementVNode(\"div\", _hoisted_3, [_hoisted_4, _createCommentVNode(\" 主要修改 :model rules ref v-model prop 添加 placeholder 与 html 代码无异\"), _createVNode(_component_el_form, {\n    model: $data.forgotPass,\n    rules: $data.rules,\n    ref: \"forgotPassForm\",\n    \"label-width\": \"80px\",\n    class: \"registerForm\",\n    \"hide-required-asterisk\": \"\",\n    onSubmit: _cache[7] || (_cache[7] = _withModifiers($event => $options.forgetPass('forgotPassForm'), [\"prevent\"]))\n  }, {\n    default: _withCtx(() => [_hoisted_5, _createVNode(_component_el_form_item, {\n      label: \"邮箱\",\n      prop: \"email\"\n    }, {\n      default: _withCtx(() => [_createVNode(_component_el_input, {\n        type: \"email\",\n        modelValue: $data.forgotPass.email,\n        \"onUpdate:modelValue\": _cache[0] || (_cache[0] = $event => $data.forgotPass.email = $event),\n        \"prefix-icon\": \"el-icon-message\",\n        placeholder: \"请输入邮箱\"\n      }, null, 8\n      /* PROPS */\n      , [\"modelValue\"])]),\n      _: 1\n      /* STABLE */\n\n    }), _createVNode(_component_el_form_item, {\n      label: \"密码\",\n      prop: \"password\"\n    }, {\n      default: _withCtx(() => [_createVNode(_component_el_input, {\n        type: $data.pwdType,\n        modelValue: $data.forgotPass.password,\n        \"onUpdate:modelValue\": _cache[2] || (_cache[2] = $event => $data.forgotPass.password = $event),\n        \"prefix-icon\": \"el-icon-lock\",\n        placeholder: \"请输入密码\"\n      }, {\n        default: _withCtx(() => [_createElementVNode(\"i\", {\n          slot: \"suffix\",\n          title: \"显示或隐藏密码\",\n          class: _normalizeClass($options.showPwd),\n          style: {\n            color: '#409eff',\n            cursor: 'pointer'\n          },\n          onClick: _cache[1] || (_cache[1] = (...args) => $options.togglePwd && $options.togglePwd(...args))\n        }, null, 2\n        /* CLASS */\n        )]),\n        _: 1\n        /* STABLE */\n\n      }, 8\n      /* PROPS */\n      , [\"type\", \"modelValue\"])]),\n      _: 1\n      /* STABLE */\n\n    }), _createVNode(_component_el_form_item, {\n      label: \"确认密码\",\n      prop: \"password2\"\n    }, {\n      default: _withCtx(() => [_createVNode(_component_el_input, {\n        type: $data.pwdType,\n        modelValue: $data.forgotPass.password2,\n        \"onUpdate:modelValue\": _cache[4] || (_cache[4] = $event => $data.forgotPass.password2 = $event),\n        \"prefix-icon\": \"el-icon-lock\",\n        placeholder: \"请确认密码\"\n      }, {\n        default: _withCtx(() => [_createElementVNode(\"i\", {\n          slot: \"suffix\",\n          title: \"显示或隐藏密码\",\n          class: _normalizeClass($options.showPwd),\n          style: {\n            color: '#409eff',\n            cursor: 'pointer'\n          },\n          onClick: _cache[3] || (_cache[3] = (...args) => $options.togglePwd && $options.togglePwd(...args))\n        }, null, 2\n        /* CLASS */\n        )]),\n        _: 1\n        /* STABLE */\n\n      }, 8\n      /* PROPS */\n      , [\"type\", \"modelValue\"])]),\n      _: 1\n      /* STABLE */\n\n    }), _createVNode(_component_el_form_item, {\n      label: \"验证码\",\n      prop: \"verifyCode\"\n    }, {\n      default: _withCtx(() => [_createElementVNode(\"div\", _hoisted_6, [_createVNode(_component_el_input, {\n        \"prefix-icon\": \"el-icon-key\",\n        modelValue: $data.forgotPass.verifyCode,\n        \"onUpdate:modelValue\": _cache[5] || (_cache[5] = $event => $data.forgotPass.verifyCode = $event),\n        placeholder: \"验证码\",\n        \"auto-complete\": \"off\"\n      }, null, 8\n      /* PROPS */\n      , [\"modelValue\"]), _createVNode(_component_el_button, {\n        type: \"primary\",\n        plain: \"\",\n        onClick: _cache[6] || (_cache[6] = $event => $options.getCode('forgotPassForm')),\n        disabled: $data.isDisabled,\n        class: \"emailcode\"\n      }, {\n        default: _withCtx(() => [_createTextVNode(_toDisplayString($data.btnMsg), 1\n        /* TEXT */\n        )]),\n        _: 1\n        /* STABLE */\n\n      }, 8\n      /* PROPS */\n      , [\"disabled\"])])]),\n      _: 1\n      /* STABLE */\n\n    }), _createElementVNode(\"div\", _hoisted_7, [_createVNode(_component_el_button, {\n      type: \"primary\",\n      \"native-type\": \"submit\",\n      class: \"confirm\"\n    }, {\n      default: _withCtx(() => [_hoisted_8]),\n      _: 1\n      /* STABLE */\n\n    })]), _createElementVNode(\"div\", _hoisted_9, [_createVNode(_component_router_link, {\n      to: \"/\"\n    }, {\n      default: _withCtx(() => [_hoisted_10]),\n      _: 1\n      /* STABLE */\n\n    }), _hoisted_11])]),\n    _: 1\n    /* STABLE */\n\n  }, 8\n  /* PROPS */\n  , [\"model\", \"rules\"])])])]);\n}","map":{"version":3,"mappings":"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","names":["class","_createElementVNode","_createElementBlock","_hoisted_4","_createCommentVNode","_createVNode","_component_el_form","model","$data","rules","ref","onSubmit","$options","_hoisted_5","_component_el_form_item","label","prop","_component_el_input","type","email","$event","placeholder","password","slot","title","style","color","cursor","onClick","password2","verifyCode","_component_el_button","plain","disabled","_component_router_link","to","_hoisted_11"],"sourceRoot":"","sources":["D:\\comp30022 frontend\\comp30022-movie-review-website\\moviehub_frontend\\src\\views\\ForgetPassword.vue"],"sourcesContent":["<template>\r\n  <div class=\"forgotpwd\">\r\n    <section class=\"form_title\">\r\n      <div class=\"manage_title\">\r\n        <span class=\"title\">影片资金后台管理系统</span>\r\n        <!-- 主要修改 :model rules ref v-model prop 添加 placeholder 与 html 代码无异-->\r\n        <el-form\r\n          :model=\"forgotPass\"\r\n          :rules=\"rules\"\r\n          ref=\"forgotPassForm\"\r\n          label-width=\"80px\"\r\n          class=\"registerForm\"\r\n          hide-required-asterisk\r\n          @submit.native.prevent=\"forgetPass('forgotPassForm')\"\r\n        >\r\n          <div class=\"forgot_title\">\r\n            <h3>忘记密码</h3>\r\n          </div>\r\n          <el-form-item label=\"邮箱\" prop=\"email\">\r\n            <el-input\r\n              type=\"email\"\r\n              v-model=\"forgotPass.email\"\r\n              prefix-icon=\"el-icon-message\"\r\n              placeholder=\"请输入邮箱\"\r\n            >\r\n            </el-input>\r\n          </el-form-item>\r\n          <el-form-item label=\"密码\" prop=\"password\">\r\n            <el-input\r\n              :type=\"pwdType\"\r\n              v-model=\"forgotPass.password\"\r\n              prefix-icon=\"el-icon-lock\"\r\n              placeholder=\"请输入密码\"\r\n            >\r\n              <i\r\n                slot=\"suffix\"\r\n                title=\"显示或隐藏密码\"\r\n                :class=\"showPwd\"\r\n                :style=\"{ color: '#409eff', cursor: 'pointer' }\"\r\n                @click=\"togglePwd\"\r\n              >\r\n              </i>\r\n            </el-input>\r\n          </el-form-item>\r\n          <el-form-item label=\"确认密码\" prop=\"password2\">\r\n            <el-input\r\n              :type=\"pwdType\"\r\n              v-model=\"forgotPass.password2\"\r\n              prefix-icon=\"el-icon-lock\"\r\n              placeholder=\"请确认密码\"\r\n            >\r\n              <i\r\n                slot=\"suffix\"\r\n                title=\"显示或隐藏密码\"\r\n                :class=\"showPwd\"\r\n                :style=\"{ color: '#409eff', cursor: 'pointer' }\"\r\n                @click=\"togglePwd\"\r\n              >\r\n              </i>\r\n            </el-input>\r\n          </el-form-item>\r\n          <el-form-item label=\"验证码\" prop=\"verifyCode\">\r\n            <div class=\"vertify\">\r\n              <el-input\r\n                prefix-icon=\"el-icon-key\"\r\n                v-model=\"forgotPass.verifyCode\"\r\n                placeholder=\"验证码\"\r\n                auto-complete=\"off\"\r\n              ></el-input>\r\n              <el-button\r\n                type=\"primary\"\r\n                plain\r\n                @click=\"getCode('forgotPassForm')\"\r\n                :disabled=\"isDisabled\"\r\n                class=\"emailcode\"\r\n              >\r\n                {{ btnMsg }}\r\n              </el-button>\r\n            </div>\r\n          </el-form-item>\r\n          <div class=\"forgot_button\">\r\n            <el-button type=\"primary\" native-type=\"submit\" class=\"confirm\"\r\n              >确定</el-button\r\n            >\r\n          </div>\r\n          <div class=\"tip_area\">\r\n            <router-link to=\"/\">想起密码，登录</router-link>\r\n            <p>注：若未收到验证码，请查看垃圾箱</p>\r\n          </div>\r\n        </el-form>\r\n      </div>\r\n    </section>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nexport default {\r\n  name: 'forgot',\r\n  data() {\r\n    const validatePass2 = (rule, value, callback) => {\r\n      if (value !== this.forgotPass.password) {\r\n        callback(new Error('两次输入密码不一致'))\r\n      } else {\r\n        callback()\r\n      }\r\n    }\r\n    return {\r\n      pwdType: 'password',\r\n      isShowPwd: false,\r\n      btnMsg: '获取邮箱验证码',\r\n      isDisabled: false,\r\n      time: 30,\r\n      forgotPass: {\r\n        email: '',\r\n        password: '',\r\n        password2: '',\r\n        verifyCode: '',\r\n      },\r\n      rules: {\r\n        email: [\r\n          { required: true, message: '邮箱不能为空', trigger: 'blur' },\r\n          { type: 'email', message: '请输入正确的邮箱地址', trigger: 'change' },\r\n        ],\r\n        password: [\r\n          { required: true, message: '密码不能为空', trigger: 'blur' },\r\n          {\r\n            min: 6,\r\n            max: 10,\r\n            message: '密码长度必须在6到10之间',\r\n            trigger: 'blur',\r\n          },\r\n        ],\r\n        password2: [\r\n          { required: true, message: '确认密码不能为空', trigger: 'blur' },\r\n          {\r\n            min: 6,\r\n            max: 10,\r\n            message: '确认密码长度必须在6到10之间',\r\n            trigger: 'blur',\r\n          },\r\n          { validator: validatePass2, trigger: 'blur' },\r\n        ],\r\n      },\r\n    }\r\n  },\r\n  computed: {\r\n    showPwd() {\r\n      return this.isShowPwd ? 'third-icon-alieye' : 'third-icon-alino_eye'\r\n    },\r\n  },\r\n  methods: {\r\n    togglePwd() {\r\n      this.pwdType === 'password'\r\n        ? (this.pwdType = '')\r\n        : (this.pwdType = 'password')\r\n      this.isShowPwd = !this.isShowPwd\r\n    },\r\n    // 验证码发送\r\n    getCode(formName) {\r\n      this.$refs[formName].validate((valid) => {\r\n        if (valid) {\r\n          this.$axios\r\n            .get('/api/users/getEmailCode', {\r\n              params: {\r\n                email: this.forgotPass.email,\r\n              },\r\n            })\r\n            .then((res) => {\r\n              // console.log(res)\r\n              if (res.data.succ) {\r\n                this.$message({\r\n                  message: '邮件已发送，请查收',\r\n                  type: 'success',\r\n                })\r\n                this.isDisabled = true\r\n                let interval = setInterval(() => {\r\n                  this.btnMsg = '' + this.time + '秒'\r\n                  --this.time\r\n                  if (this.time < 0) {\r\n                    this.btnMsg = '获取邮箱验证码'\r\n                    this.time = 30\r\n                    this.isDisabled = false\r\n                    clearInterval(interval)\r\n                  }\r\n                }, 1000)\r\n              }\r\n            })\r\n        }\r\n      })\r\n    },\r\n    // 修改密码\r\n    forgetPass(formName) {\r\n      this.$refs[formName].validate((valid) => {\r\n        if (valid) {\r\n          this.$axios\r\n            .put('/api/users/resetPass', this.forgotPass)\r\n            .then((res) => {\r\n              // console.log(res)\r\n              if (res.data.success) {\r\n                this.$message({\r\n                  message: res.data.message,\r\n                  type: 'success',\r\n                })\r\n                setTimeout(() => {\r\n                  history.pushState({}, '', '/login') //跳转到登录界面\r\n                  location.reload()\r\n                }, 1000)\r\n              } else {\r\n                this.$message({\r\n                  message: res.data.message,\r\n                  type: 'error',\r\n                })\r\n              }\r\n            })\r\n            .catch((err) => {\r\n              this.$message({\r\n                message: '系统错误!',\r\n                type: 'error',\r\n              })\r\n              console.log('Error', err)\r\n            })\r\n        }\r\n      })\r\n    },\r\n  },\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n.forgotpwd {\r\n  position: relative;\r\n  width: 100%;\r\n  height: 100%;\r\n  background: url(../assets/login-bg.jpg) no-repeat center center;\r\n  background-size: 100% 100%;\r\n}\r\n.form_title {\r\n  width: 370px;\r\n  height: 210px;\r\n  position: absolute;\r\n  top: 5%;\r\n  left: 34%;\r\n  padding: 25px;\r\n  border-radius: 5px;\r\n  text-align: center;\r\n}\r\n.form_title .manage_title .title {\r\n  font-family: 'Microsoft YaHei';\r\n  font-weight: bold;\r\n  font-size: 26px;\r\n  color: #111;\r\n}\r\n.forgot_title {\r\n  margin-bottom: 20px;\r\n  text-align: center;\r\n  color: #505458;\r\n}\r\n.registerForm {\r\n  margin-top: 20px;\r\n  background-color: #fff;\r\n  padding: 20px 40px 20px 20px;\r\n  border-radius: 5px;\r\n  box-shadow: 0px 5px 10px #cccc;\r\n}\r\n.vertify {\r\n  display: flex;\r\n  justify-content: space-between;\r\n}\r\n.vertify >>> .emailcode {\r\n  margin-left: 10px;\r\n  font-size: 10px;\r\n}\r\n.forgot_button {\r\n  padding-left: 80px;\r\n}\r\n.confirm {\r\n  width: 100%;\r\n}\r\n.tip_area {\r\n  text-align: left;\r\n  font-size: 12px;\r\n  color: #333;\r\n  margin-top: 20px;\r\n}\r\n.tip_area a {\r\n  color: #409eff;\r\n}\r\n.tip_area p {\r\n  margin-top: 15px;\r\n  color: gray;\r\n}\r\n</style>"]},"metadata":{},"sourceType":"module"}