{"ast":null,"code":"import qs from \"qs\";\nexport default {\n  name: \"forgetpwd\",\n  props: [\"centerDialogVisibleSecond\"],\n\n  data() {\n    return {\n      getCode: \"\",\n      sendcode: \"发送验证码\",\n      disabled: false,\n      forgetpwdform: {\n        phone: \"\",\n        code: \"\",\n        newpassword: \"\",\n        repeatpassword: \"\"\n      },\n      rules: {\n        phone: [{\n          required: true,\n          message: \"手机号不能为空\",\n          trigger: \"blur\"\n        }],\n        code: [{\n          required: true,\n          message: \"验证码不能为空\",\n          trigger: \"blur\"\n        }],\n        newpassword: [{\n          required: true,\n          message: \"新密码不能为空\",\n          trigger: \"blur\"\n        }],\n        repeatpassword: [{\n          required: true,\n          message: \"重置密码不能为空\",\n          trigger: \"blur\"\n        }]\n      }\n    };\n  },\n\n  methods: {\n    //手机号正则判断\n    judgePhone() {\n      const reg = /^((13[0-9])|(14[5,7,9])|(15[^4])|(18[0-9])|(17[0,1,3,5,6,7,8]))\\d{8}$/; //var url=\"/nptOfficialWebsite/apply/sendSms?mobile=\"+this.ruleForm.phone;\n\n      if (this.forgetpwdform.phone == '') {\n        this.$message(\"请输入手机号码\");\n        return false;\n      } else if (!reg.test(this.forgetpwdform.phone)) {\n        this.$message(\"手机号格式不正确\");\n        return false;\n      } else {\n        return true;\n      }\n    },\n\n    //发送验证码\n    sendcodeMsg() {\n      let _this = this;\n\n      if (_this.judgePhone()) {\n        var num = 60;\n        var timer = setInterval(function () {\n          num--;\n          _this.disabled = true;\n          _this.sendcode = num + '秒后重新获取';\n\n          if (num === 0) {\n            _this.sendcode = '获取验证码';\n            _this.disabled = false;\n            clearInterval(timer);\n          }\n        }, 1000);\n\n        _this.$http.post(\"你的接口\", qs.stringify({\n          phoneNumber: _this.forgetpwdform.phone\n        })).then(res => {\n          _this.getCode = res;\n        });\n      }\n    },\n\n    //关闭页面\n    handleClose() {\n      this.centerDialogVisibleSecond = false;\n      this.$emit(\"tyonke\", this.centerDialogVisibleSecond);\n    },\n\n    //表单提交\n    handleSubmit() {\n      let _this = this;\n\n      _this.$refs['forgetpwdform'].validate(valid => {\n        if (valid) {\n          if (_this.forgetpwdform.code != _this.getCode) {\n            this.$message({\n              type: \"error\",\n              message: \"修改失败\",\n              duration: 1000\n            });\n            return false;\n          }\n\n          return this.$message({\n            type: \"success\",\n            message: \"修改成功\",\n            duration: 1000\n          });\n        } else {\n          return;\n        }\n      });\n    }\n\n  },\n  watch: {\n    centerDialogVisibleSecond(newValue, oldValue) {\n      this.centerDialogVisibleSecond = newValue;\n    }\n\n  }\n};","map":{"version":3,"mappings":"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","names":["qs","name","props","data","getCode","sendcode","disabled","forgetpwdform","phone","code","newpassword","repeatpassword","rules","required","message","trigger","methods","judgePhone","reg","$message","test","sendcodeMsg","_this","num","timer","setInterval","clearInterval","$http","post","stringify","phoneNumber","then","res","handleClose","centerDialogVisibleSecond","$emit","handleSubmit","$refs","validate","valid","type","duration","watch","newValue","oldValue"],"sourceRoot":"","sources":["D:\\comp30022 frontend\\comp30022-movie-review-website\\moviehub_frontend\\src\\views\\ForgetPassword.vue"],"sourcesContent":["<template>\r\n  <el-dialog title=\"忘记密码\"\r\n             :visible.sync=\"centerDialogVisibleSecond\"\r\n             width=\"30%\"\r\n             :before-close=\"handleClose\"\r\n  >\r\n      <el-form label-width=\"120px\" ref=\"forgetpwdform\" :model=\"forgetpwdform\" :rules=\"rules\">\r\n          <el-row :gutter=\"20\">\r\n              <el-col :span=\"14\">\r\n                  <el-form-item prop=\"phone\" label=\"手机号：\">\r\n                      <el-input v-model=\"forgetpwdform.phone\" maxlength=\"11\"></el-input>\r\n                  </el-form-item>\r\n              </el-col>\r\n              <el-col :span=\"10\">\r\n                  <el-button @click=\"sendcodeMsg\" :disabled=\"disabled\">{\r\n {sendcode}}</el-button>\r\n              </el-col>\r\n          </el-row>\r\n          <el-row>\r\n              <el-col>\r\n                  <el-form-item prop=\"code\" label=\"验证码：\">\r\n                      <el-input v-model=\"forgetpwdform.code\"></el-input>\r\n                  </el-form-item>\r\n              </el-col>\r\n          </el-row>\r\n          <el-form-item prop=\"newpassword\" label=\"新密码\">\r\n              <el-input type=\"password\" v-model=\"forgetpwdform.newpassword\"></el-input>\r\n          </el-form-item>\r\n          <el-form-item prop=\"repeatpassword\" label=\"确认密码\">\r\n              <el-input type=\"password\" v-model=\"forgetpwdform.repeatpassword\"></el-input>\r\n          </el-form-item>\r\n\r\n      </el-form>\r\n      <template slot=\"footer\">\r\n          <el-button type=\"default\" @click=\"handleClose\">取消</el-button>\r\n          <el-button type=\"primary\" @click=\"handleSubmit\">提交</el-button>\r\n      </template>\r\n  </el-dialog>\r\n</template>\r\n\r\n<script>\r\n  import qs from \"qs\"\r\n\r\n  export default {\r\n      name: \"forgetpwd\",\r\n      props: [\"centerDialogVisibleSecond\"],\r\n      data() {\r\n          return {\r\n              getCode: \"\",\r\n              sendcode: \"发送验证码\",\r\n              disabled: false,\r\n              forgetpwdform: {\r\n                  phone: \"\",\r\n                  code: \"\",\r\n                  newpassword: \"\",\r\n                  repeatpassword: \"\"\r\n              },\r\n              rules: {\r\n                  phone: [\r\n                      {required: true, message: \"手机号不能为空\", trigger: \"blur\"}\r\n                  ],\r\n                  code: [\r\n                      {\r\n                          required: true, message: \"验证码不能为空\", trigger: \"blur\"\r\n                      },\r\n                  ],\r\n                  newpassword: [\r\n                      {\r\n                          required: true, message: \"新密码不能为空\", trigger: \"blur\"\r\n                      },\r\n                  ],\r\n                  repeatpassword: [\r\n                      {\r\n                          required: true, message: \"重置密码不能为空\", trigger: \"blur\"\r\n                      }\r\n                  ]\r\n              }\r\n          }\r\n      },\r\n      methods: {\r\n          //手机号正则判断\r\n          judgePhone() {\r\n              const reg = /^((13[0-9])|(14[5,7,9])|(15[^4])|(18[0-9])|(17[0,1,3,5,6,7,8]))\\d{8}$/;\r\n              //var url=\"/nptOfficialWebsite/apply/sendSms?mobile=\"+this.ruleForm.phone;\r\n              if (this.forgetpwdform.phone == '') {\r\n                  this.$message(\"请输入手机号码\")\r\n                  return false;\r\n              } else if (!reg.test(this.forgetpwdform.phone)) {\r\n                  this.$message(\"手机号格式不正确\")\r\n                  return false;\r\n              } else {\r\n                  return true;\r\n              }\r\n          },\r\n          //发送验证码\r\n          sendcodeMsg() {\r\n              let _this = this;\r\n              if (_this.judgePhone()) {\r\n                  var num = 60;\r\n                  var timer = setInterval(function () {\r\n                      num--;\r\n                      _this.disabled = true;\r\n                      _this.sendcode = num + '秒后重新获取';\r\n                      if (num === 0) {\r\n                          _this.sendcode = '获取验证码';\r\n                          _this.disabled = false;\r\n                          clearInterval(timer)\r\n                      }\r\n                  }, 1000)\r\n                  _this.$http.post(\"你的接口\", qs.stringify(\r\n                      {phoneNumber: _this.forgetpwdform.phone}\r\n                  )).then((res) => {\r\n                      _this.getCode = res;\r\n                  })\r\n              }\r\n\r\n          },\r\n          //关闭页面\r\n          handleClose() {\r\n              this.centerDialogVisibleSecond = false;\r\n              this.$emit(\"tyonke\", this.centerDialogVisibleSecond);\r\n          },\r\n\r\n          //表单提交\r\n          handleSubmit() {\r\n              let _this = this;\r\n              _this.$refs['forgetpwdform'].validate(valid => {\r\n                  if (valid) {\r\n                      if (_this.forgetpwdform.code != _this.getCode) {\r\n                          this.$message({\r\n                              type: \"error\",\r\n                              message: \"修改失败\",\r\n                              duration: 1000\r\n                          })\r\n                          return false;\r\n                      }\r\n                      return this.$message({\r\n                          type: \"success\",\r\n                          message: \"修改成功\",\r\n                          duration: 1000\r\n                      })\r\n                  } else {\r\n                      return\r\n                  }\r\n              })\r\n          }\r\n      },\r\n      watch: {\r\n          centerDialogVisibleSecond(newValue, oldValue) {\r\n              this.centerDialogVisibleSecond = newValue;\r\n          }\r\n      }\r\n  }\r\n</script>\r\n\r\n<style scoped>\r\n\r\n</style>\r\n\r\n"]},"metadata":{},"sourceType":"module"}